// https://thingspeak.com/channels/1712062

[{"id":"bed1fd30.33f358","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"5c18ef70.bf34e","type":"inject","z":"bed1fd30.33f358","name":"","topic":"","payload":"","payloadType":"flow","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":240,"wires":[["977a60e6.7484c"]]},{"id":"977a60e6.7484c","type":"file in","z":"bed1fd30.33f358","name":"File","filename":"/home/user/Desktop/iot-feeds.csv","format":"lines","chunk":false,"sendError":false,"x":390,"y":240,"wires":[["429aeaf3.a2ba0c"]]},{"id":"429aeaf3.a2ba0c","type":"csv","z":"bed1fd30.33f358","name":"","sep":",","hdrin":false,"hdrout":"","multi":"one","ret":"\\n","temp":"code,field1,field2,field3,field4,field5,field6,field7","skip":"0","x":590,"y":240,"wires":[["bfbb2a16.5bbbb","6788bbc6.22fdd4"]]},{"id":"6788bbc6.22fdd4","type":"function","z":"bed1fd30.33f358","name":"Function1","func":"if(msg.payload.code < 4842 && msg.payload.code >= 4742) \n{\n msg.topic = \"channels/1712062/publish\"\n msg.payload = \"field1=\"+msg.payload.field1+\"&field2=\"+msg.payload.field2+\"&field5=\"+msg.payload.field5;\n return msg;\n}","outputs":1,"noerr":0,"x":750,"y":320,"wires":[["f6801ad3.b227b8"]]},{"id":"f6801ad3.b227b8","type":"delay","z":"bed1fd30.33f358","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":940,"y":360,"wires":[["5b91d5af.305734"]]},{"id":"5b91d5af.305734","type":"mqtt out","z":"bed1fd30.33f358","name":"","topic":"","qos":"","retain":"","broker":"d9a0a712.1a56","x":1110,"y":440,"wires":[]},{"id":"394d234a.15757c","type":"ui_chart","z":"bed1fd30.33f358","name":"","group":"f7001132.c6e78","order":0,"width":0,"height":0,"label":"chart","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1210,"y":320,"wires":[[],[]]},{"id":"bfbb2a16.5bbbb","type":"function","z":"bed1fd30.33f358","name":"Function2","func":"if(msg.payload.code < 4842 && msg.payload.code >= 4742) \n{\n msg.payload = msg.payload.field5;\n return msg;\n}\n","outputs":1,"noerr":0,"x":810,"y":240,"wires":[["fba4ae04.0a866"]]},{"id":"fba4ae04.0a866","type":"delay","z":"bed1fd30.33f358","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"30","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":960,"y":280,"wires":[["394d234a.15757c"]]},{"id":"f5adacf7.5e6cb8","type":"debug","z":"bed1fd30.33f358","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":540,"y":360,"wires":[]},{"id":"d9a0a712.1a56","type":"mqtt-broker","z":"","name":"","broker":"mqtt3.thingspeak.com","port":"1883","clientid":"FhEbDzs0OQ8uJjkeJiYsBi4","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"f7001132.c6e78","type":"ui_group","z":"","name":"Default","tab":"d8b4017a.7a744","disp":true,"width":"6","collapse":false},{"id":"d8b4017a.7a744","type":"ui_tab","z":"","name":"RSSI","icon":"dashboard","order":1}]
